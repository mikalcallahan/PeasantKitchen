<!DOCTYPE HTML>
<html>
<head>

<script type="text/javascript">
	function UserReadInWebSocketTest() {
		if ("WebSocket" in window) {
			alert("WebSocket is supported by your Browser!");

			// Let us open a web socket
			var ws = new WebSocket("ws://localhost:8080/Peasant_Kitchen/recipe"); //If want to look at response of different websocket change /create

			ws.onopen = function() {
				// Web Socket is connected, send data using send()
				alert("Message is sent...");

				ingredientArray = ['Ground Beef', 'Pasta Sauce', 'Spaghetti Noodles'];
				requestObject = {
					username : "mr user",  ingredients: ingredientArray
					
				}; //Changes when switching
				//evenBetterRequestObject = {id: "user.create", payload: requestObject} //Doesn't change
				evenBetterRequestObject = {
					id : "exact",
					payload : requestObject
				}

				ws.send(JSON.stringify(evenBetterRequestObject));

			};

			ws.onmessage = function(evt) {
				//var received_msg = evt.data;
				alert('Recieved: [' + received_msg + ']');

				var response = JSON.parse(evt.data); //gives response and error fields (just a json string) response from create new user. this only looks at Response class in websocket (not request)
				var responseObject = response.response; //you don't have access to functions in class (createnewuser, signinuser, etc)
				var error = response.error;

				if (error == null || error == undefined)
				{
					if (responseObject.username == NULL) 
					{
						alert("Username does not exist");
					} 
					else if (responseObject.username.contains(" "))
					{
						alert("More than 1 user name entered");
					}
					else if (responseObject.ingredients.contains('Ground Beef'))
					{
						alert("1st Ingredient found.");
					}
					else if (responseObject.ingredients.contains('Pasta Sauce')
					{
						alert("2nd Ingredient found.");
					}
					else if (responseObject.ingredients.contains('Spaghetti Noodles')
					{
						alert("3rd Ingredient found.");
					}
				} 
				else 
				{
					alert(JSON.stringify(error))
				}

			

			};

			ws.onclose = function() {
				// websocket is closed.
				alert("Connection is closed...");
			};
		}

		else {
			// The browser doesn't support WebSocket
			alert("WebSocket NOT supported by your Browser!");
		}
	}
</script>

</head>
<body>

	<div id="sse">
		<a href="javascript:WebSocketTest()">Run WebSocket</a>
	</div>

</body>
</html>